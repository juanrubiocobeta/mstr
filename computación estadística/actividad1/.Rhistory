# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 600, m = 250, p = 200)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 200)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
resultado_ejemplo <- puntos(n = 6008, m = 2500, p = 200)
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 2900)
resultado_ejemplo <- puntos(n = 60098, m = 250, p = 200)
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(120)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 6008, m = 250, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
resultado_ejemplo <- puntos(n = 60008, m = 250, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60008, m = 250, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60008, m = 2500, p = 30)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60008, m = 2500, p = 90)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60008, m = 2500, p = 99)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60008, m = 2500e4, p = 99)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60, m =1, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60, m =2, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60, m =25, p = 20)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(123)
# Llamamos a la función con los valores del ejemplo.
cat("Ejecutando la función puntos(n = 60, m = 25, p = 20) con seed=123:\n")
resultado_ejemplo <- puntos(n = 60, m =25, p = 20)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
# Llamamos a la función con los valores del ejemplo.
resultado_ejemplo <- puntos(n = 60, m =1, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
resultado_ejemplo <- puntos(n = 60, m =1, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
resultado_ejemplo <- puntos(n = 60, m =1e5, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
# Fijamos una semilla para que el resultado del ejemplo sea reproducible.
# Si quieres un resultado diferente cada vez, puedes poner un '#' al inicio de la línea siguiente.
set.seed(1200)
resultado_ejemplo <- puntos(n = 60, m =1e6, p = 100)
# Imprimimos el resultado final en la consola.
cat("El resultado final es:", resultado_ejemplo, "\n")
library(patchwork)
install.packages("patchwork")
library(patchwork)
# 1. Versión MODIFICADA de la función 'puntos'
# Ahora devuelve una lista con el resultado y la urna de origen.
puntos <- function(n, m, p) {
urna_elegida <- sample(c("dados", "naipes"), size = 1)
if (urna_elegida == "dados") {
num_dados_a_sacar <- ceiling(n * p / 100)
lanzamientos <- sample(1:6, size = num_dados_a_sacar, replace = TRUE)
resultado <- trunc(mean(lanzamientos))
} else {
urna_naipes <- rep(c(10, 11, 12), times = m)
num_naipes_a_sacar <- ceiling(length(urna_naipes) * p / 100)
naipes_extraidos <- sample(urna_naipes, size = num_naipes_a_sacar)
resultado <- sum(naipes_extraidos)
}
# El cambio clave: devolver una lista con ambos datos.
return(list(urna = urna_elegida, resultado = resultado))
}
# 2. Nueva función 'grafica'
grafica <- function(k, n, m, p) {
# Validamos que k sea mayor que 10
if (k <= 10) {
stop("El valor de k debe ser mayor que 10.")
}
# Replicamos la función 'puntos' k veces SIN BUCLES
# simplify=FALSE asegura que obtenemos una lista de listas
lista_resultados <- replicate(k, puntos(n, m, p), simplify = FALSE)
# Convertimos la lista de listas en un data.frame ordenado
df_resultados <- dplyr::bind_rows(lista_resultados)
# Filtramos los resultados para cada urna
resultados_dados <- df_resultados[df_resultados$urna == "dados", ]
resultados_naipes <- df_resultados[df_resultados$urna == "naipes", ]
# Gráfico para los dados (Histograma con ancho de barra 1)
plot_dados <- ggplot(resultados_dados, aes(x = resultado)) +
geom_histogram(binwidth = 1, fill = "#0072B2", color = "white", alpha = 0.8) +
labs(title = "Distribución de Resultados: Urna de Dados",
x = "Valor Medio Truncado", y = "Frecuencia") +
theme_minimal()
# Gráfico para los naipes (Histograma estándar)
plot_naipes <- ggplot(resultados_naipes, aes(x = resultado)) +
geom_histogram(fill = "#D55E00", color = "white", alpha = 0.8) +
labs(title = "Distribución de Resultados: Urna de Naipes",
x = "Suma de Puntuaciones", y = "Frecuencia") +
theme_minimal()
# Combinamos y mostramos ambos gráficos en la misma ventana con patchwork
plot_final <- plot_dados + plot_naipes
print(plot_final)
}
# Para que el resultado sea reproducible, fijamos una semilla.
set.seed(999)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 1000, n = 100, m = 30, p = 15)
# 2. Nueva función 'grafica'
grafica <- function(k, n, m, p) {
# Validamos que k sea mayor que 10
if (k <= 10) {
stop("El valor de k debe ser mayor que 10.")
}
# Replicamos la función 'puntos' k veces SIN BUCLES
# simplify=FALSE asegura que obtenemos una lista de listas
lista_resultados <- replicate(k, puntos(n, m, p), simplify = FALSE)
# Convertimos la lista de listas en un data.frame ordenado
df_resultados <- dplyr::bind_rows(lista_resultados)
# Filtramos los resultados para cada urna
resultados_dados <- df_resultados[df_resultados$urna == "dados", ]
resultados_naipes <- df_resultados[df_resultados$urna == "naipes", ]
# Gráfico para los dados (Histograma con ancho de barra 1)
plot_dados <- ggplot(resultados_dados, aes(x = resultado)) +
geom_histogram(binwidth = 1, fill = "#0072B2", color = "white", alpha = 0.8) +
labs(title = "Dados",
x = "Valor Medio Truncado", y = "Frecuencia") +
theme_minimal()
# Gráfico para los naipes (Histograma estándar)
plot_naipes <- ggplot(resultados_naipes, aes(x = resultado)) +
geom_histogram(fill = "#D55E00", color = "white", alpha = 0.8) +
labs(title = "Naipes",
x = "Suma de Puntuaciones", y = "Frecuencia") +
theme_minimal()
# Combinamos y mostramos ambos gráficos en la misma ventana con patchwork
plot_final <- plot_dados + plot_naipes
print(plot_final)
}
# Para que el resultado sea reproducible, fijamos una semilla.
set.seed(999)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 1000, n = 100, m = 30, p = 15)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 10, n = 1, m = 30, p = 100)
# 2. Nueva función 'grafica'
grafica <- function(k, n, m, p) {
# Validamos que k sea mayor que 10
if (k <= 10) {
stop("El valor de k debe ser mayor que 10.")
}
# Replicamos la función 'puntos' k veces SIN BUCLES
# simplify=FALSE asegura que obtenemos una lista de listas
lista_resultados <- replicate(k, puntos(n, m, p), simplify = FALSE)
# Convertimos la lista de listas en un data.frame ordenado
df_resultados <- dplyr::bind_rows(lista_resultados)
# Filtramos los resultados para cada urna
resultados_dados <- df_resultados[df_resultados$urna == "dados", ]
resultados_naipes <- df_resultados[df_resultados$urna == "naipes", ]
# Gráfico para los dados (Histograma con ancho de barra 1)
plot_dados <- ggplot(resultados_dados, aes(x = resultado)) +
geom_histogram(binwidth = 1, fill = "#0072B2", color = "white", alpha = 0.8) +
labs(title = "Dados",
x = "Valor Medio Truncado", y = "Frecuencia") +
theme_minimal()
# Gráfico para los naipes (Histograma estándar)
plot_naipes <- ggplot(resultados_naipes, aes(x = resultado)) +
geom_histogram(fill = "#D55E00", color = "white", alpha = 0.8) +
labs(title = "Naipes",
x = "Suma de Puntuaciones", y = "Frecuencia") +
theme_minimal()
# Combinamos y mostramos ambos gráficos en la misma ventana con patchwork
plot_final <- plot_dados + plot_naipes
print(plot_final)
}
# Para que el resultado sea reproducible, fijamos una semilla.
set.seed(999)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 10, n = 1, m = 30, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 11, n = 1, m = 30, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 1, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 100, m = 30, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 1000, m = 30, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 30, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 3000, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 3000, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 30, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 30000, p = 100)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 30000, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 100, n = 10, m = 300, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 1000, n = 10, m = 300, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 1000, n = 100, m = 300, p = 50)
# Llamamos a la función con un número alto de simulaciones.
grafica(k = 1000, n = 10, m = 300, p = 50)
library(patchwork)
puntos <- function(n, m, p) {
urna_elegida <- sample(c("dados", "naipes"), size = 1)
if (urna_elegida == "dados") {
num_dados_a_sacar <- ceiling(n * p / 100)
lanzamientos <- sample(1:6, size = num_dados_a_sacar, replace = TRUE)
resultado <- trunc(mean(lanzamientos))
} else {
urna_naipes <- rep(c(10, 11, 12), times = m)
num_naipes_a_sacar <- ceiling(length(urna_naipes) * p / 100)
naipes_extraidos <- sample(urna_naipes, size = num_naipes_a_sacar)
resultado <- sum(naipes_extraidos)
}
# El cambio clave: devolver una lista con ambos datos.
return(list(urna = urna_elegida, resultado = resultado))
}
# 2. Nueva función 'grafica'
grafica <- function(k, n, m, p) {
if (k <= 10) {
stop("El valor de k debe ser mayor que 10.")
}
lista_resultados <- replicate(k, puntos(n, m, p), simplify = FALSE)
df_resultados <- dplyr::bind_rows(lista_resultados)
resultados_dados <- df_resultados[df_resultados$urna == "dados", ]
resultados_naipes <- df_resultados[df_resultados$urna == "naipes", ]
plot_dados <- ggplot(resultados_dados, aes(x = resultado)) +
geom_histogram(binwidth = 1, fill = "#0072B2", color = "white", alpha = 0.8) +
labs(title = "Dados",
x = "Valor Medio Truncado", y = "Frecuencia") +
theme_minimal()
plot_naipes <- ggplot(resultados_naipes, aes(x = resultado)) +
geom_histogram(fill = "#D55E00", color = "white", alpha = 0.8) +
labs(title = "Naipes",
x = "Suma de Puntuaciones", y = "Frecuencia") +
theme_minimal()
plot_final <- plot_dados + plot_naipes
print(plot_final)
}
set.seed(999)
grafica(k = 1000, n = 10, m = 300, p = 50)
library(ggplot2)
# ----- Parte 1: Lógica vectorizada del experimento -----
proporcion_A_mayor <- function(n) {
lanzamientos_A <- sample(1:6, size = n, replace = TRUE)
lanzamientos_B <- sample(1:6, size = n, replace = TRUE)
A_gana <- lanzamientos_A > lanzamientos_B
return(sum(A_gana) / n)
}
# ----- Parte 2: Repetición del experimento para visualizar la convergencia -----
n_max_lanzamientos <- 2000
vector_n <- 1:n_max_lanzamientos
set.seed(2025)
proporciones_calculadas <- sapply(vector_n, proporcion_A_mayor)
# ----- Parte 3: Creación del gráfico -----
datos_grafico <- data.frame(
Numero_de_Lanzamientos = vector_n,
Proporcion = proporciones_calculadas
)
prob_teorica <- 15/36
grafico_convergencia <- ggplot(datos_grafico, aes(x = Numero_de_Lanzamientos, y = Proporcion)) +
geom_line(color = "#0072B2") +
geom_hline(aes(yintercept = prob_teorica), color = "red", linetype = "dashed", size = 1) +
labs(
title = "Convergencia de la Proporción de Victorias del Dado A sobre B",
subtitle = paste("La línea roja representa la probabilidad teórica de", round(prob_teorica, 4)),
x = "Número de Lanzamientos (n)",
y = "Proporción (A > B)"
) +
theme_minimal()
print(grafico_convergencia)
# Cargamos la librería 'tidyverse', que incluye las herramientas necesarias
# (readr para leer datos, dplyr para manipularlos y knitr para tablas).
library(tidyverse)
# 1. Carga de datos
# Leemos el fichero. Asumimos que es un fichero separado por comas (CSV).
# Si el separador fuera otro (ej. tabulador), usaríamos read_tsv() o read_delim().
fichero_datos <- "datossociales (1).txt"
datos <- read_csv(fichero_datos)
View(datos)
# 2. Procesamiento y análisis de datos (sin bucles)
# Se encadenan operaciones para agrupar por continente y calcular las estadísticas.
resumen_por_continente <- datos %>%
group_by(continente) %>%
summarise(
esperanza_vida_media = mean(esperanza_vida, na.rm = TRUE),
mortalidad_infantil_media = mean(mort_infantil, na.rm = TRUE),
fecundidad_media = mean(nhijos, na.rm = TRUE),
numero_paises = n()
) %>%
arrange(desc(esperanza_vida_media)) # Ordenamos para una mejor lectura
# Cargamos las librerías necesarias para leer datos, manipularlos y graficar.
library(tidyverse)
# --- 1. Carga y Preparación de Datos ---
cat("--- 1. Carga y Preparación de Datos ---\n")
# Leemos el fichero. Es importante usar read_tsv() porque las columnas están separadas por tabulaciones.
datos <- read_tsv("datossociales (1).txt")
# Filtramos para un año reciente (2017) para que las comparaciones sean actuales y coherentes.
# También calculamos el PIB per cápita, que es mejor para comparar riqueza entre países.
# Eliminamos filas donde falten datos clave para nuestro análisis.
datos_2017 <- datos %>%
filter(año == 2017) %>%
mutate(pib_per_capita = pib / poblacion) %>%
drop_na(esperanza_vida, pib_per_capita, nhijos)
cat("Datos del año 2017 cargados y listos para el análisis.\n\n")
# --- 2. Cálculo de Máximos y Mínimos Coherentes ---
cat("--- 2. Análisis de Extremos (Máximos y Mínimos) en 2017 ---\n\n")
# Países con MAYOR esperanza de vida
cat("Top 5 países con MAYOR esperanza de vida:\n")
top5_vida <- datos_2017 %>%
arrange(desc(esperanza_vida)) %>%
select(pais, esperanza_vida) %>%
head(5)
print(knitr::kable(top5_vida))
# Países con MENOR esperanza de vida
cat("\nTop 5 países con MENOR esperanza de vida:\n")
bottom5_vida <- datos_2017 %>%
arrange(esperanza_vida) %>%
select(pais, esperanza_vida) %>%
head(5)
print(knitr::kable(bottom5_vida))
# Países con MAYOR PIB per cápita
cat("\nTop 5 países con MAYOR PIB per cápita:\n")
top5_pib <- datos_2017 %>%
arrange(desc(pib_per_capita)) %>%
select(pais, pib_per_capita) %>%
head(5)
print(knitr::kable(top5_pib, digits=0))
# --- 3. Gráfico Comparativo por Continente ---
cat("\n--- 3. Gráfico Comparativo por Continente ---\n")
cat("A continuación se muestra la esperanza de vida media para cada continente.\n\n")
# Agrupamos por continente y calculamos la media de la esperanza de vida
resumen_continentes <- datos_2017 %>%
group_by(continente) %>%
summarise(esperanza_vida_media = mean(esperanza_vida, na.rm = TRUE))
# Creamos el gráfico de barras
grafico_comparativo <- ggplot(resumen_continentes, aes(x = fct_reorder(continente, esperanza_vida_media), y = esperanza_vida_media)) +
geom_col(fill = "skyblue", color = "black") +
coord_flip() + # Giramos el gráfico para que los nombres se lean mejor
labs(
title = "Esperanza de Vida Media por Continente (2017)",
x = "Continente",
y = "Esperanza de Vida Media (años)"
) +
theme_minimal()
# Imprimimos el gráfico para que se muestre en el documento
print(grafico_comparativo)
media=0.5
x<-seq(-5,5,length.out=1000)
aproxnormal<-function(n,m)
{
datos<-matrix(runif(n*m,0,1),nrow=n)
Xns<-colMeans(datos)
simplifico<-(Xns-media)*sqrt(n)*sqrt(12)
plot(x,dnorm(x,0,1),type="l")
lines(density(simplifico),col="red")
}
aproxnormal(1000,500)
# Definimos la función para la simulación del TCL
aproxnormal <- function(n, m) {
# Media teórica de una distribución Uniforme(0,1) es (0+1)/2 = 0.5
media_teorica <- 0.5
# Varianza teórica de una U(0,1) es (1-0)^2 / 12 = 1/12
varianza_teorica <- 1/12
# Generamos m*n valores de una U(0,1) y los organizamos en una matriz
# donde cada columna es una muestra de tamaño n.
datos <- matrix(runif(n * m, 0, 1), nrow = n)
# Calculamos la media de cada muestra (de cada columna)
medias_muestrales <- colMeans(datos)
# Estandarizamos las medias muestrales según el TCL: (Xn - μ) / (σ / sqrt(n))
# Esto es algebraicamente equivalente a (Xn - μ) * sqrt(n) / σ
medias_estandarizadas <- (medias_muestrales - media_teorica) * sqrt(n) / sqrt(varianza_teorica)
# Graficamos la densidad Normal estándar (nuestro objetivo teórico)
plot(
seq(-4, 4, length.out = 1000),
dnorm(seq(-4, 4, length.out = 1000), 0, 1),
type = "l",
main = paste("Aproximación con n =", n),
xlab = "Valor Estandarizado",
ylab = "Densidad",
col = "black",
lwd = 2 # Ancho de línea
)
# Superponemos la densidad de nuestras medias muestrales estandarizadas
lines(density(medias_estandarizadas), col = "red", lwd = 2)
# Añadimos una leyenda para mayor claridad
legend("topright", legend = c("Normal Estándar Teórica", "Densidad de Medias Simuladas"),
col = c("black", "red"), lty = 1, lwd = 2, bty = "n")
}
# Ejecutamos la simulación para varios valores de n para comparar
# par(mfrow=c(2,2)) crea una ventana gráfica de 2x2 para verlos todos juntos
par(mfrow = c(2, 2))
aproxnormal(n = 2, m = 10000)
aproxnormal(n = 5, m = 10000)
aproxnormal(n = 30, m = 10000)
aproxnormal(n = 1000, m = 10000)
# Devolvemos la configuración gráfica a su estado original (1x1)
par(mfrow = c(1, 1))
media<-0.5
x<-seq(-5,5,length.out=1000)
aproxnormal<-function(n,m)
{
datos<-matrix(runif(n*m,0,1),nrow=n)
Xns<-colMeans(datos)
simplifico<-(Xns-media)*sqrt(n) *sqrt(12)
plot(x, dnorm(x,0,1),type="l",main= paste("Aproximaciónconn=",n))
lines(density(simplifico),col="red")
legend("topright",legend=c("NormalTeórica","SimulaciónUniforme"),
col=c("black","red"),lty=1,cex=0.8,bty="n")
}
aproxnormal(1000,500)
plot(x, dnorm(x,0,1),type="l",main= paste("Aproximación con=",n))
aproxnormal<-function(n,m)
{
datos<-matrix(runif(n*m,0,1),nrow=n)
Xns<-colMeans(datos)
simplifico<-(Xns-media)*sqrt(n) *sqrt(12)
plot(x, dnorm(x,0,1),type="l",main= paste("Aproximación con=",n))
lines(density(simplifico),col="red")
legend("topright",legend=c("NormalTeórica","SimulaciónUniforme"),
col=c("black","red"),lty=1,cex=0.8,bty="n")
}
aproxnormal(1000,500)
aproxnormal(1000,5000)
aproxnormal(10000,5000)
aproxnormal(10000,50090)
